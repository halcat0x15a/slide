<html>
      <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
        <title>start_scalaz</title>
        <link href="assets/css/show.css" type="text/css" rel="stylesheet" />
        <link href="assets/css/prettify.css" type="text/css" rel="stylesheet" />
        <script type="text/javascript" src="assets/js/jquery.min.js"></script>
        <script type="text/javascript" src="assets/js/show.js"></script>
        <script type="text/javascript" src="assets/js/prettify/prettify.js"></script>
        <script type="text/javascript" src="assets/js/prettify/lang-apollo.js"></script><script type="text/javascript" src="assets/js/prettify/lang-css.js"></script><script type="text/javascript" src="assets/js/prettify/lang-hs.js"></script><script type="text/javascript" src="assets/js/prettify/lang-lisp.js"></script><script type="text/javascript" src="assets/js/prettify/lang-lua.js"></script><script type="text/javascript" src="assets/js/prettify/lang-ml.js"></script><script type="text/javascript" src="assets/js/prettify/lang-proto.js"></script><script type="text/javascript" src="assets/js/prettify/lang-scala.js"></script><script type="text/javascript" src="assets/js/prettify/lang-sql.js"></script><script type="text/javascript" src="assets/js/prettify/lang-sql.js"></script><script type="text/javascript" src="assets/js/prettify/lang-vb.js"></script><script type="text/javascript" src="assets/js/prettify/lang-vhdl.js"></script><script type="text/javascript" src="assets/js/prettify/lang-wiki.js"></script><script type="text/javascript" src="assets/js/prettify/lang-yaml.js"></script>
      <script type="text/javascript"><!--
        window.onload=function() { prettyPrint(); };
      --></script>
      </head>
      <body>
        <div id="slides">
          <div id="reel">
            <div class="content" id="slide-0">
       <div class="container"><h1>Start Scalaz!</h1></div>
      </div><div class="content" id="slide-1">
       <div class="container"><h1>会場案内とか？</h1></div>
      </div><div class="content" id="slide-2">
       <div class="container"><h1>発表者</h1><ul><li>よしださんしろう(<a href="https://twitter.com/halcat0x15a" >halcat0x15a</a>)
</li><li>Scala, Clojure, Haskellとか
</li><li>Scalaは2.5年くらい書いてます
</li><li>大学生になりました
</li><li>夏休みです
</li></ul></div>
      </div><div class="content" id="slide-3">
       <div class="container"><h1>今日の内容</h1><ul><li>Type Class
</li><li>Scalaz7
</li></ul></div>
      </div><div class="content" id="slide-4">
       <div class="container"><ul><li><a href="http://halcat0x15a.github.com/scalaz/core/target/scala-2.9.2/api/" >apidoc</a>
</li><li>build.sbt
</li></ul><pre><code class="prettyprint lang-scala">scalaVersion := &quot;2.10.0-M5&quot;

resolvers += &quot;Typesafe Snapshots&quot; at &quot;http://repo.typesafe.com/typesafe/snapshots/&quot;

libraryDependencies ++= Seq(
  &quot;org.scalaz&quot; %% &quot;scalaz-core&quot; % &quot;7.0-SNAPSHOT&quot;
)

scalacOptions += &quot;-feature&quot;
</code></pre></div>
      </div><div class="content" id="slide-5">
       <div class="container"><ul><li>発表中のツッコミは大歓迎
</li><li>わからないところがあったら聞いて下さい
</li><li>適当に休憩をとります
</li></ul></div>
      </div><div class="content" id="slide-6">
       <div class="container"><h1>Type Class</h1></div>
      </div><div class="content" id="slide-7">
       <div class="container"><h1>Scalazの例</h1><h2>ある値を２倍する</h2><pre><code class="prettyprint lang-scala">import scalaz, Scalaz

def double[A](a: A)(implicit s: Semigroup[A]) = s.append(a, a)

double(2) assert_=== 4
double(&quot;2&quot;) assert_=== &quot;22&quot;
</code></pre></div>
      </div><div class="content" id="slide-8">
       <div class="container"><h1>Semigroup</h1><h2>appendは抽象メソッド、２つの値を結合する関数</h2><h3>Pointを例にインスタンスを定義してみる</h3><pre><code class="prettyprint lang-scala">case class Point(x: Int, y: Int) {
  def +(p: Point) = Point(x + p.x, y + p.y)
}

object Point {
  implicit object PointInstance extends Semigroup[Point] {
    def append(p1: Point, p2: =&gt; Point) = p1 + p2
  }
}
</code></pre></div>
      </div><div class="content" id="slide-9">
       <div class="container"><h3>Semigroup[Point]のインスタンスが暗黙的に渡される</h3><pre><code class="prettyprint lang-scala">import Point._
double(Point(1, 2))
</code></pre></div>
      </div><div class="content" id="slide-10">
       <div class="container"><h1>Law</h1><h2>Lawは型クラス内にtraitとして定義されてる</h2><h3>appendの定義はSemigroupLawを満たしていなければならない</h3><pre><code class="prettyprint lang-scala">append(f1, append(f2, f3)) == append(append(f1, f2), f3)
</code></pre></div>
      </div><div class="content" id="slide-11">
       <div class="container"><h1>Show</h1><h2>文字列へ変換する関数を定義する</h2><h3>複数のインスタンスはmix-inや、別のimplicit parameterを定義することで実現する</h3><pre><code class="prettyprint lang-scala">object Point {
  implicit object PointInstance extends Show[Point] with Semigroup[Point] {
    def show(p: Point) = p.toString.toList
    def append(p1: Point, p2: =&gt; Point) = p1 + p2
  }
}
</code></pre></div>
      </div><div class="content" id="slide-12">
       <div class="container"><h1>Context Bound</h1><h2>型クラスを利用するとき、明示的にimplicit parameterを書かないことが多い</h2><h3>次の関数は同じ動作をする</h3><pre><code class="prettyprint lang-scala">def quote[A](a: A)(implicit s: Show[A]) = s.show(a).mkString(&quot;'&quot;, &quot;&quot;, &quot;'&quot;)
def quote[A: Show](a: A) = implicitly[Show[A]].show(a).mkString(&quot;'&quot;, &quot;&quot;, &quot;'&quot;)
</code></pre></div>
      </div><div class="content" id="slide-13">
       <div class="container"><h1>Scalaz</h1></div>
      </div><div class="content" id="slide-14">
       <div class="container"><h1>パッケージ</h1><ul><li><p>scalaz
</p><ul><li>型クラスとデータ型
</li></ul></li><li><p>scalaz.std
</p><ul><li>標準ライブラリに対する型クラスのインスタンス
</li></ul></li><li><p>scalaz.syntax
</p><ul><li>シンタックス
</li></ul></li></ul></div>
      </div><div class="content" id="slide-15">
       <div class="container"><h1>命名規則</h1><ul><li><p>Instances
</p><ul><li>データ型に対する型クラスのインスタンス
</li></ul></li><li><p>Functions
</p><ul><li>データ型に関係した関数
</li></ul></li><li><p>Ops
</p><ul><li>型クラスに関係したメソッド
</li></ul></li><li><p>Syntax
</p><ul><li>暗黙の型変換、型クラスに関係した関数
</li></ul></li></ul></div>
      </div><div class="content" id="slide-16">
       <div class="container"><h1>型クラスのコンパニオンオブジェクト</h1><ul><li>型クラスに関係した関数
</li><li>applyはインスタンスを得る
</li></ul><pre><code class="prettyprint lang-scala">def double[A: Semigroup](a: A) = Semigroup[A].append(a, a)
</code></pre></div>
      </div><div class="content" id="slide-17">
       <div class="container"><h1>データ型のコンパニオンオブジェクト</h1><h2>InstancesとFunctionsを継承している</h2></div>
      </div><div class="content" id="slide-18">
       <div class="container"><h1>Syntax</h1></div>
      </div><div class="content" id="slide-19">
       <div class="container"><h2>先の例は次の様に書ける</h2><pre><code class="prettyprint lang-scala">def double[A: Semigroup](a: A) = a |+| a
</code></pre></div>
      </div><div class="content" id="slide-20">
       <div class="container"><h1>|+|</h1><h2>SemigroupOpsに定義されてるメソッド</h2><h3>Semigroupのインスタンスを持つ型に対して暗黙の型変換がされる</h3><pre><code class="prettyprint lang-scala">def double[A: Semigroup](a: A) = ToSemigroupOps(a) |+| a
</code></pre></div>
      </div><div class="content" id="slide-21">
       <div class="container"><h1>scalaz.syntax</h1><h2>インスタンスが存在すればOpsで定義されたメソッドが使える</h2><h3>主要な関数のほとんどはシンタックスが定義されている</h3><pre><code class="prettyprint lang-scala">def quote[A: Show](a: A) = Show[A].show(a).mkString(&quot;'&quot;, &quot;&quot;, &quot;'&quot;)
def quote[A: Show](a: A) = a.show.mkString(&quot;'&quot;, &quot;&quot;, &quot;'&quot;)
</code></pre></div>
      </div><div class="content" id="slide-22">
       <div class="container"><h1>Monoid</h1></div>
      </div><div class="content" id="slide-23">
       <div class="container"><h2>Semigroupに恒等元を加えたもの</h2><h3>Rationalの例</h3><pre><code class="prettyprint lang-scala">case class Rational(n: Int, d: Int) {
  def +(r: Rational) = Rational(n * r.d + r.n * d, d * r.d)
}

object Rational {
  implicit object RationalInstance extends Monoid[Rational] {
    def zero = Rational(0, 1)
    def append(r1: Rational, r2: =&gt; Rational) = r1 + r2
  }
}
</code></pre></div>
      </div><div class="content" id="slide-24">
       <div class="container"><h1>MonoidLaw</h1><h2>恒等元の性質</h2><pre><code class="prettyprint lang-scala">append(zero, a) == a
append(a, zero) == a
</code></pre></div>
      </div><div class="content" id="slide-25">
       <div class="container"><h1>主な関数</h1><ul><li>mzero
</li><li>multiply
</li><li>Monoid.replicate
</li><li>Monoid.unfold
</li></ul><pre><code class="prettyprint lang-scala">mzero[Int] assert_=== 0
mzero[Option[String]] assert_=== None
3 multiply 5 assert_=== 15
&quot;geso&quot; multiply 2 assert_=== &quot;gesogeso&quot;
Monoid.replicate[List, Int](0)(3, 1 +) assert_=== List(0, 1, 2)
Monoid.unfold[List, List[Int], Int](List(1, 2, 3)) {
  case Nil =&gt; None
  case x :: xs =&gt; Some(x * 2 -&gt; xs)
} assert_=== List(2, 4, 6)
</code></pre></div>
      </div><div class="content" id="slide-26">
       <div class="container"><h1>問題</h1><ul><li>replicateを用いて偶数列からn個取得する関数evens
</li><li>unfoldを用いて10進数から2進数へ変換する関数encode
</li></ul><pre><code class="prettyprint lang-scala">def evens(n: Int): List[Int]
def encode(n: Int): List[Int]
evens(5) assert_=== List(0, 2, 4, 6, 8)
encode(13) assert_=== List(1, 0, 1, 1)
</code></pre></div>
      </div><div class="content" id="slide-27">
       <div class="container"><h1>Group</h1><h2>逆元を持つMonoid</h2><pre><code class="prettyprint lang-scala">def zero[A: Group](a: A) = a |+| a.inverse
def zero[A: Group](a: A) = a |-| a
</code></pre></div>
      </div><div class="content" id="slide-28">
       <div class="container"><h1>Plus, PlusEmpty</h1><h2>量化されたSemigroup, Monoid</h2><h3>Plusは要素の性質に依存しない</h3></div>
      </div><div class="content" id="slide-29">
       <div class="container"><h2>&lt;+&gt;</h2><pre><code class="prettyprint lang-scala">List(1, 2) |+| List(3, 4) assert_=== List(1, 2, 3, 4)
List(1, 2) &lt;+&gt; List(3, 4) assert_=== List(1, 2, 3, 4)
Option(1) |+| Option(1) assert_=== Option(2)
Option(1) &lt;+&gt; Option(1) assert_=== Option(1)
</code></pre></div>
      </div><div class="content" id="slide-30">
       <div class="container"><h1>Order</h1></div>
      </div><div class="content" id="slide-31">
       <div class="container"><h1>Equal</h1><h2>等価性</h2><pre><code class="prettyprint lang-scala">case class Point(x: Int, y: Int)

object Point {
  implicit object PointInstance extends Equal[Point] {
    def equal(p1: Point, p2: Point) = p1 == p2
  }
}

import Point._
assert(Point(2, 3) === Point(2, 3))
assert(Point(2, 3) =/= Point(3, 5))
</code></pre></div>
      </div><div class="content" id="slide-32">
       <div class="container"><h1>型安全な演算</h1><h2>Scalazの関数はジェネリクスを利用している</h2><pre><code class="prettyprint lang-scala">1 == &quot;geso&quot;
// compile error
// 1 === &quot;geso&quot;

1 + 1.5
// compile error
// 1 |+| 1.5
</code></pre></div>
      </div><div class="content" id="slide-33">
       <div class="container"><h1>Order</h1><h2>順序</h2><pre><code class="prettyprint lang-scala">case class Rational(n: Int, d: Int)

object Rational {
  implicit object RationalInstance extends Order[Rational] {
    def order(r1: Rational, r2: Rational) = r1.n * r2.d -&gt; r2.n * r1.d match {
      case (m, n) if m == n =&gt; Ordering.EQ
      case (m, n) if m &lt; n =&gt; Ordering.LT
      case (m, n) if m &gt; n =&gt; Ordering.GT
    }
  }
}

import Rational._
assert(Rational(1, 2) === Rational(1, 2))
assert(Rational(1, 2) &lt; Rational(3, 4))
assert(Rational(5, 2) &gt;= Rational(5, 3))
</code></pre></div>
      </div><div class="content" id="slide-34">
       <div class="container"><h1>Ordering</h1><h2>Javaのcompareが返す-1、0、1に対応します。</h2><h3>Orderingはモノイドであるため、複数の比較結果を結合することができます。</h3><pre><code class="prettyprint lang-scala">mzero[Ordering] assert_=== Ordering.EQ
(Ordering.EQ: Ordering) |+| Ordering.LT assert_=== Ordering.LT
(Ordering.GT: Ordering) |+| Ordering.LT assert_=== Ordering.GT
(Ordering.GT: Ordering) |+| Ordering.EQ assert_=== Ordering.GT
</code></pre></div>
      </div><div class="content" id="slide-35">
       <div class="container"><h2>Orderingを利用したsort</h2><pre><code class="prettyprint lang-scala">case class Person(name: String, age: Int, height: Int)

object Person {
  implicit object PersonInstance extends Show[Person] with Order[Person] {
    def show(p: Person) = p.toString.toList
    def order(p1: Person, p2: Person) =
      p1.age ?|? p2.age |+| p1.height ?|? p2.height
  }
}

val miku = Person(&quot;miku&quot;, 16, 158)
val rin = Person(&quot;rin&quot;, 14, 152)
val len = Person(&quot;len&quot;, 14, 156)
import Person._
List(miku, rin, len) sorted PersonInstance.toScalaOrdering assert_=== List(rin, len, miku)
</code></pre></div>
      </div><div class="content" id="slide-36">
       <div class="container"><h1>問題</h1><ul><li>java.util.Dateに対するOrderのインスタンス
</li><li><p>以下のクラスに対するOrderのインスタンス
</p><ul><li>gradeとbirthdayを用いる
</li><li>ただしgrade重きを置く
</li></ul></li></ul><pre><code class="prettyprint lang-scala">case class Student(name: String, grade: Int, birthday: Date)

val format = new java.text.SimpleDateFormat(&quot;MM dd&quot;)
val akari = Student(&quot;akari&quot;, 1, format.parse(&quot;07 24&quot;))
val kyoko = Student(&quot;kyoko&quot;, 2, format.parse(&quot;03 28&quot;))
val yui = Student(&quot;yui&quot;, 2, format.parse(&quot;04 22&quot;))
val chinatsu = Student(&quot;chinatsu&quot;, 1, format.parse(&quot;11 06&quot;))
List(akari, kyoko, yui, chinatsu).sorted(StudentOrder.toScalaOrdering) assert_=== List(akari, chinatsu, kyoko, yui)
</code></pre></div>
      </div><div class="content" id="slide-37">
       <div class="container"><h1>Enum</h1><h2>Orderにsuccessorとpredecessorを加えたもの</h2><pre><code class="prettyprint lang-scala">2.succ assert_=== 3
'b'.pred assert_=== 'a'
'a' -+- 2 assert_=== 'c'
1 --- 3 assert_=== -2
1 |-&gt; 3 assert_=== List(1, 2, 3)
'a' |--&gt; (2, 'f') assert_=== List('a', 'c', 'e')
</code></pre></div>
      </div><div class="content" id="slide-38">
       <div class="container"><h1>Monad</h1></div>
      </div><div class="content" id="slide-39">
       <div class="container"><h1>Higher Kinds</h1><h2>型をパラメータとしてとる型</h2><pre><code class="prettyprint lang-scala">import scala.language.higherKinds
def triple[F[_]: Plus, A](fa: F[A]) = fa &lt;+&gt; fa &lt;+&gt; fa
triple(Option(1)) assert_=== Option(1)
triple(List(1)) assert_=== List(1, 1, 1)
</code></pre></div>
      </div><div class="content" id="slide-40">
       <div class="container"><h1>Functor</h1><h2>map</h2><h3>関数をコンテナに包まれた値に適用する</h3><pre><code class="prettyprint lang-scala">def appendAll[F[_]: Functor, A: Semigroup](fa: F[A], a: A) = fa.map(_ |+| a)
appendAll(List(1, 2, 3), 1) assert_=== List(2, 3, 4)
appendAll(1.some, 4) assert_=== Some(5)
</code></pre></div>
      </div><div class="content" id="slide-41">
       <div class="container"><h1>FunctorLaw</h1><h2>mapの性質</h2><pre><code class="prettyprint lang-scala">map(fa)(x =&gt; x) == fa
map(map(fa)(f))(g) == map(fa)(g compose f)
</code></pre></div>
      </div><div class="content" id="slide-42">
       <div class="container"><h1>Pointed</h1><h2>コンテナを構築する</h2><pre><code class="prettyprint lang-scala">Pointed[List].point(1) assert_=== List(1)
Pointed[Option].point(1) assert_=== Some(1)
</code></pre></div>
      </div><div class="content" id="slide-43">
       <div class="container"><h1>型の部分適用</h1><pre><code class="prettyprint lang-scala">assert(Functor[({ type F[A] = Either[String, A] })#F].map(Right(1))(_.succ) === Right(2))
assert(Pointed[({ type F[A] = Either[String, A] })#F].point(1) === Right(1))
</code></pre></div>
      </div><div class="content" id="slide-44">
       <div class="container"><h1>Apply</h1><h2>コンテナに包まれた関数をコンテナに包まれた値に適用する</h2><pre><code class="prettyprint lang-scala">Option(0) &lt;*&gt; Option(Enum[Int].succ _) assert_=== Option(1)
List(1, 2, 3) &lt;*&gt; List(Enum[Int].pred _) assert_=== List(0, 1, 2)
</code></pre></div>
      </div><div class="content" id="slide-45">
       <div class="container"><h1>Applicative</h1><h2>ApplyとPointedを組み合わせたもの</h2><h3>mapはap(&lt;*&gt;)とpointによって実装される</h3><pre><code class="prettyprint lang-scala">def inverseAll[F[_]: Applicative, A: Group](fa: F[A]) = fa &lt;*&gt; Pointed[F].point(Group[A].inverse _)
inverseAll(Option(1)) assert_=== Option(-1)
inverseAll(List(1, 2, 3)) assert_=== List(-1, -2, -3)
</code></pre></div>
      </div><div class="content" id="slide-46">
       <div class="container"><h1>ApplicativeLaw</h1><pre><code class="prettyprint lang-scala">ap(fa)(point((a: A) =&gt; a)) == fa
ap(ap(fa)(fab))(fbc) == ap(fa)(ap(fab)(ap(fbc)(point((bc: B =&gt; C) =&gt; (ab: A =&gt; B) =&gt; bc compose ab))))
ap(point(a))(point(ab)) == point(ab(a))
ap(point(a))(f) == ap(f)(point((f: A =&gt; B) =&gt; f(a)))
</code></pre></div>
      </div><div class="content" id="slide-47">
       <div class="container"><h1>Applicative Style</h1><pre><code class="prettyprint lang-scala">def append3[F[_]: Applicative, A: Semigroup](a: F[A], b: F[A], c: F[A]) = (a |@| b |@| c)(_ |+| _ |+| _)
append3(Option(1), Option(2), Option(3)) assert_=== Option(6)
append3(Option(1), None, Option(3)) assert_=== None
append3(List(1), List(1, 2), List(1, 2, 3)) assert_=== List(3, 4, 5, 4, 5, 6)
</code></pre></div>
      </div><div class="content" id="slide-48">
       <div class="container"><h1>Bind</h1></div>
      </div><div class="content" id="slide-49">
       <div class="container"><h1>Monad</h1></div>
      </div>
          </div>
        </div>
        
      </body>
    </html>